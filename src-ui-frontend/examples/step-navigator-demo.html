<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Step Navigator Demo</title>
    <link rel="stylesheet" href="/styles.css" />
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
      }

      #nav-container {
        /* Navigator will be placed here */
      }

      .demo-content {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
      }

      .step-content {
        display: none;
        padding: 2rem;
        background: var(--bg-secondary);
        border-radius: var(--radius);
        box-shadow: var(--shadow-md);
        margin-top: 1rem;
      }

      .step-content.active {
        display: block;
        animation: fadeIn 0.3s ease-in;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .demo-controls {
        margin-top: 2rem;
        padding: 1rem;
        background: var(--bg-accent);
        border-radius: var(--radius);
      }

      .demo-controls button {
        margin: 0.5rem;
        padding: 0.5rem 1rem;
        background: var(--button-primary);
        color: white;
        border: none;
        border-radius: var(--radius);
        cursor: pointer;
      }

      .demo-controls button:hover {
        background: var(--button-primary-hover);
      }

      h2 {
        color: var(--text-primary);
        margin-top: 0;
      }

      p {
        color: var(--text-secondary);
        line-height: 1.6;
      }
    </style>
  </head>
  <body>
    <div id="nav-container"></div>

    <div class="demo-content">
      <div id="step-1" class="step-content active">
        <h2>Step 1: Choose Your Use Case</h2>
        <p>
          Select the type of device you want to optimize: Headphones, Speakers,
          Microphones, or use custom measurement files.
        </p>
        <p>
          This is where users will see large icons for each use case, making it
          easy to choose their workflow.
        </p>
      </div>

      <div id="step-2" class="step-content">
        <h2>Step 2: Data Acquisition</h2>
        <p>
          Acquire measurement data for your device. This can be from:
        </p>
        <ul>
          <li>Online database (speakers/headphones)</li>
          <li>Live capture using a microphone</li>
          <li>CSV files from external measurements</li>
        </ul>
      </div>

      <div id="step-3" class="step-content">
        <h2>Step 3: Optimization</h2>
        <p>
          Configure and run the EQ optimization algorithm. View real-time
          progress and results.
        </p>
        <p>Forms on the left, plots on the right - the core optimization interface.</p>
      </div>

      <div id="step-4" class="step-content">
        <h2>Step 4: Listening</h2>
        <p>
          Test your optimized EQ by playing audio through the audio player.
          Compare with/without EQ enabled.
        </p>
        <p>This is where the audio player bar appears.</p>
      </div>

      <div id="step-5" class="step-content">
        <h2>Step 5: Saving</h2>
        <p>
          Export your EQ settings and save your measurement data for future
          reference.
        </p>
        <p>
          Simple export options for various EQ formats (APO, RME, AUPreset,
          etc.)
        </p>
      </div>

      <div class="demo-controls">
        <h3>Demo Controls</h3>
        <button onclick="demo.navigator.goToStep(1)">Go to Step 1</button>
        <button onclick="demo.navigator.goToStep(3)">Go to Step 3</button>
        <button onclick="demo.navigator.goToStep(5)">Go to Step 5</button>
        <button onclick="demo.toggleStep(4)">Toggle Step 4 Enabled</button>
      </div>
    </div>

    <script type="module">
      import { StepNavigator } from "../modules/step-navigator.ts";

      // Initialize the step navigator
      const container = document.getElementById("nav-container");

      const steps = [
        { id: 1, label: "Choose Use Case", shortLabel: "Use Case", enabled: true },
        { id: 2, label: "Data Acquisition", shortLabel: "Data", enabled: true },
        { id: 3, label: "Optimization", shortLabel: "Optimize", enabled: true },
        { id: 4, label: "Listening", shortLabel: "Listen", enabled: true },
        { id: 5, label: "Saving", shortLabel: "Save", enabled: true },
      ];

      const navigator = new StepNavigator(container, {
        steps,
        currentStep: 1,
        onStepChange: (stepId) => {
          console.log("Step changed to:", stepId);
          showStepContent(stepId);
        },
        onPrevious: () => {
          console.log("Previous button clicked");
        },
        onNext: () => {
          console.log("Next button clicked");
        },
      });

      function showStepContent(stepId) {
        // Hide all step contents
        document.querySelectorAll(".step-content").forEach((el) => {
          el.classList.remove("active");
        });

        // Show the selected step content
        const stepContent = document.getElementById(`step-${stepId}`);
        if (stepContent) {
          stepContent.classList.add("active");
        }
      }

      // Make demo functions available globally for button onclick
      window.demo = {
        navigator,
        toggleStep: (stepId) => {
          const step = steps.find((s) => s.id === stepId);
          if (step) {
            step.enabled = !step.enabled;
            navigator.setStepEnabled(stepId, step.enabled);
            console.log(`Step ${stepId} enabled:`, step.enabled);
          }
        },
      };

      console.log("Step Navigator Demo loaded!");
    </script>
  </body>
</html>
